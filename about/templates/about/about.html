{% extends 'base.html' %}
{% load static %}

{% block title %}Nuestra Filosofía y Equipo | LE WORK Constructora{% endblock %}

{# BLOQUE: extra_head - CSS y precargas importantes #}
{% block extra_head %}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet" as="font" crossorigin>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/swiper@8/swiper-bundle.min.css" />

    <style>

        /* Estilos personalizados para los botones de Swiper (Ajusta los colores a tu marca) */
        .swiper-button-next, .swiper-button-prev {
            color: #d1d5db; /* Tailwind: gray-300 */
            transition: color 0.2s;
        }
        .swiper-button-next:hover, .swiper-button-prev:hover {
            color: #ffffff; /* Tailwind: white */
        }
        .swiper-pagination-bullet-active {
            background: #ffffff; /* Tailwind: white */
        }
    </style>
{% endblock %}


{% block content %}

    <!-- =================================================================== -->
    <!-- HERO SECTION: Fondo negro sólido para un look minimalista y potente -->
    <!-- =================================================================== -->
<section id="hero-about" class="relative w-full h-72 md:h-96 flex items-center justify-center bg-brand-dark text-white overflow-hidden shadow-xl">
    <!-- Capa de imagen de fondo con efecto parallax sutil -->
    <div class="absolute inset-0 bg-cover bg-center bg-no-repeat transition-transform duration-500 ease-out z-0"
         style="background-image: url('ruta/a/tu-imagen-de-fondo-aqui.jpg');"
         data-parallax-speed="0.2">
        <!-- Overlay oscuro para asegurar la legibilidad del texto blanco sobre la imagen -->
        <div class="absolute inset-0 bg-brand-dark opacity-60"></div>
    </div>

    <!-- Contenido del Hero: Centrado -->
    <div class="container mx-auto px-4 text-center relative z-10">
        <h1 id="hero-about-heading" class="text-4xl md:text-6xl font-oswald font-extrabold leading-tight tracking-tight mb-4" data-aos="fade-up">
            {% if about_us and about_us.title %}{{ about_us.title }}{% else %}Construyendo Sueños, Cimentando Futuros.{% endif %}
        </h1>
        <p class="text-lg md:text-xl font-light max-w-2xl mx-auto" data-aos="fade-up" data-aos-delay="200">
            Descubre la pasión, experiencia y compromiso que nos define como líderes en el sector de la construcción.
        </p>
    </div>
</section>

    <!-- =================================================================== -->
    <!-- SECCIÓN DE FILOSOFÍA: Misión, Visión, Valores -->
    <!-- =================================================================== -->
    <section id="philosophy" class="py-20 md:py-28 bg-gray-50">
        <div class="container mx-auto px-4 lg:px-8">
            
            <nav class="mb-12 text-gray-500" aria-label="Breadcrumb" data-aos="fade-up">
                <ol class="flex items-center space-x-2 justify-center">
                    <li><a href="{% url 'core:home' %}" class="hover:underline text-primary-600 transition-colors duration-200">Inicio</a></li>
                    <li class="text-gray-400">/</li>
                    <li aria-current="page" class="font-semibold text-gray-700">Quiénes Somos</li>
                </ol>
            </nav>

            <div class="text-center mb-16" data-aos="fade-up">
                <h2 class="text-3xl md:text-4xl font-oswald font-bold text-gray-800">Nuestra Filosofía de Trabajo</h2>
                <p class="mt-3 max-w-2xl mx-auto text-lg text-gray-600">
                    {% if main_content %}{{ main_content }}{% else %}Más que construir edificios, creamos relaciones duraderas basadas en la confianza y la excelencia.{% endif %}
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 md:gap-10">
                <div class="bg-white p-8 rounded-xl border border-gray-200/80 shadow-sm hover:shadow-xl hover:-translate-y-2 transition-all duration-300" data-aos="fade-up" data-aos-delay="100">
                    <div class="flex items-center text-primary-600 mb-4"><i class="fas fa-bullseye text-3xl"></i><h3 class="ml-4 text-2xl font-oswald font-bold text-gray-900">Misión</h3></div>
                    <p class="text-gray-600 leading-relaxed">{% if mission %}{{ mission|linebreaksbr }}{% else %}Definir nuestra misión...{% endif %}</p>
                </div>
                <div class="bg-white p-8 rounded-xl border border-gray-200/80 shadow-sm hover:shadow-xl hover:-translate-y-2 transition-all duration-300" data-aos="fade-up" data-aos-delay="200">
                    <div class="flex items-center text-primary-600 mb-4"><i class="fas fa-eye text-3xl"></i><h3 class="ml-4 text-2xl font-oswald font-bold text-gray-900">Visión</h3></div>
                    <p class="text-gray-600 leading-relaxed">{% if vision %}{{ vision|linebreaksbr }}{% else %}Definir nuestra visión...{% endif %}</p>
                </div>
                <div class="bg-white p-8 rounded-xl border border-gray-200/80 shadow-sm hover:shadow-xl hover:-translate-y-2 transition-all duration-300" data-aos="fade-up" data-aos-delay="300">
                    <div class="flex items-center text-primary-600 mb-4"><i class="fas fa-handshake text-3xl"></i><h3 class="ml-4 text-2xl font-oswald font-bold text-gray-900">Valores</h3></div>
                    <ul class="space-y-3">
                        {% for value in values %}
                            <li class="flex items-center text-gray-600">
                                {% if value.icon %}<img src="{{ value.icon.url }}" alt="Icono de {{ value.name }}" class="w-6 h-6 mr-3 flex-shrink-0" width="24" height="24" loading="lazy">
                                {% else %}<i class="fas fa-check-circle text-primary-500 mr-3"></i>{% endif %}
                                <span>{{ value.name }}</span>
                            </li>
                        {% empty %}
                            <li class="text-gray-500">No hay valores configurados.</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- =================================================================== -->
    <!-- SECCIÓN EL EQUIPO: Diseño de tarjeta interactivo -->
    <!-- =================================================================== -->
    <section id="team" class="py-20 md:py-28 bg-white" aria-labelledby="team-heading">
        <div class="container mx-auto px-4 lg:px-8">
            <div class="text-center mb-16" data-aos="fade-up">
                <h2 id="team-heading" class="text-3xl md:text-4xl font-oswald font-bold text-gray-800">El Talento Detrás del Éxito</h2>
                <p class="mt-3 max-w-2xl mx-auto text-lg text-gray-600">Un equipo multidisciplinar de profesionales apasionados por la excelencia y la innovación.</p>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 justify-items-center">
                {% for member in team_members %}
                    <article class="group relative w-full max-w-sm rounded-xl overflow-hidden cursor-pointer team-member-card-item-trigger"
                             data-aos="fade-up" data-aos-delay="{% widthratio forloop.counter0 1 100 %}"
                             role="button" tabindex="0" aria-label="Ver detalles de {{ member.name }}"
                             data-member-name="{{ member.name }}" data-member-title="{{ member.title }}"
                             data-member-bio="{{ member.bio|striptags|safe }}"
                             data-member-image="{% if member.image %}{{ member.image.url }}{% else %}{% static 'core/img/team_member_placeholder.jpg' %}{% endif %}">
                        
                        <img src="{% if member.image %}{{ member.image.url }}{% else %}{% static 'core/img/team_member_placeholder.jpg' %}{% endif %}" 
                             alt="Retrato de {{ member.name }}"
                             class="w-full h-96 {% if member.is_logo %}object-contain p-8 bg-gray-100{% else %}object-cover{% endif %} object-center transition-transform duration-500 ease-in-out group-hover:scale-110"
                             loading="lazy" width="400" height="384">
                        
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-6 text-white w-full">
                            <h3 class="text-2xl font-oswald font-bold group-hover:text-primary-400 transition-colors duration-300">{{ member.name }}</h3>
                            <p class="text-primary-300 font-medium">{{ member.title }}</p>
                            <span class="mt-4 inline-block text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300">Ver más →</span>
                        </div>
                    </article>
                {% empty %}
                    <p class="col-span-full text-center text-lg text-gray-500 p-8 bg-gray-50 rounded-lg">Próximamente presentaremos a nuestro equipo de expertos.</p>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- =================================================================== -->
    <!-- SECCIÓN DE TESTIMONIOS: Estructura corregida para visibilidad y funcionalidad -->
    <!-- =================================================================== -->
    <section id="testimonials" class="py-20 md:py-28 bg-primary-700 text-white" aria-labelledby="testimonials-heading">
        <div class="container mx-auto px-4 lg:px-8">
            <div class="text-center mb-16" data-aos="fade-up">
                <h2 id="testimonials-heading" class="text-3xl md:text-4xl font-oswald font-bold">La Voz de Nuestros Clientes</h2>
                <p class="mt-3 max-w-2xl mx-auto text-lg text-primary-200">La confianza que depositan en nosotros es nuestro mayor logro.</p>
            </div>
            
            <div class="relative" data-aos="fade-up" data-aos-delay="200">
                <div class="swiper mySwiper w-full rounded-xl overflow-hidden min-h-[480px] pb-16">
                    <div class="swiper-wrapper">
                        {% for testimonial in testimonials %}
                            <div class="swiper-slide h-full p-2 sm:p-4">
                                <blockquote class="flex flex-col h-full bg-white text-gray-800 p-8 rounded-xl shadow-lg">
                                    <div class="flex-grow"><i class="fas fa-quote-left text-primary-200 text-3xl mb-4"></i><p class="text-gray-600 italic leading-relaxed">"{{ testimonial.content }}"</p></div>
                                    <footer class="mt-6 flex items-center">
                                        {% if testimonial.image %}<img src="{{ testimonial.image.url }}" alt="Avatar de {{ testimonial.client_name }}" class="w-14 h-14 rounded-full object-cover border-2 border-primary-500" width="56" height="56" loading="lazy">
                                        {% else %}<img src="{% static 'core/img/avatar_placeholder.jpg' %}" alt="Avatar por defecto" class="w-14 h-14 rounded-full object-cover border-2 border-primary-300" width="56" height="56" loading="lazy">{% endif %}
                                        <cite class="ml-4 not-italic"><span class="block font-bold text-gray-900">{{ testimonial.client_name }}</span><span class="block text-sm text-gray-500">{{ testimonial.project_type|default:'Cliente Satisfecho' }}</span></cite>
                                    </footer>
                                </blockquote>
                            </div>
                        {% empty %}
                            <div class="swiper-slide flex items-center justify-center"><p class="text-center text-lg text-primary-200 p-8">Aún no tenemos testimonios públicos.</p></div>
                        {% endfor %}
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>
        </div>
    </section>

    <!-- =================================================================== -->
    <!-- CTA FINAL: Cierre potente para impulsar la acción -->
    <!-- =================================================================== -->
    <section id="final-cta" class="bg-gray-100">
        <div class="container mx-auto px-4 py-20 md:py-24">
            <div class="bg-white rounded-2xl shadow-xl p-10 md:p-16 text-center" data-aos="fade-up">
                <h2 class="text-3xl md:text-4xl font-oswald font-bold text-gray-800">¿Listo para empezar tu próximo gran proyecto?</h2>
                <p class="mt-3 max-w-2xl mx-auto text-lg text-gray-600">Nuestro equipo está listo para escuchar tus ideas y convertirlas en realidad. Contáctanos hoy y demos el primer paso juntos.</p>
                <div class="mt-8">
                    {# NOTA: Verifica que el nombre de tu ruta de contacto sea 'contact_us' y que no requiera un namespace. #}
                    <a href="{% url 'core:contact' %}" class="inline-block bg-primary-600 text-white font-bold py-4 px-10 rounded-lg text-xl hover:bg-primary-700 transition-colors duration-300 transform hover:scale-105 shadow-lg">
                        Hablemos de tu Proyecto
                    </a>
                </div>
            </div>
            
        </div>
    </section>

    <!-- =================================================================== -->
    <!-- MODAL DEL EQUIPO: Estructura oculta activada por JS -->
    <!-- =================================================================== -->
    <div id="team-member-modal" class="modal-overlay fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 hidden z-50">
        <div class="modal-content bg-white p-8 rounded-xl shadow-2xl relative w-full max-w-2xl mx-auto transform scale-95 transition-all duration-300">
            <button id="close-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-800 text-3xl" aria-label="Cerrar">×</button>
            <div class="md:flex md:space-x-8 items-start">
                <img id="modal-member-image" src="" alt="Foto de miembro del equipo" class="w-32 h-32 md:w-40 md:h-40 rounded-full object-cover border-4 border-primary-500 mb-6 mx-auto md:mx-0 flex-shrink-0" width="160" height="160">
                <div class="text-center md:text-left">
                    <h3 id="modal-member-name" class="text-3xl font-oswald font-bold text-gray-900"></h3>
                    <p id="modal-member-title" class="text-primary-600 text-lg font-medium mb-4"></p>
                    <p id="modal-member-bio" class="text-gray-600 text-base leading-relaxed max-h-60 overflow-y-auto"></p>
                </div>
            </div>
                  
        </div>
    </div>
{% endblock %}


{% block extra_scripts %}
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>

    <script>
        
        document.addEventListener('DOMContentLoaded', function () {
            // 1. Inicializar AOS (Animaciones al hacer scroll)
            AOS.init({ duration: 800, once: true, offset: 50 });


            // 3. Lógica del Modal del Equipo
            const modal = document.getElementById('team-member-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const teamMemberTriggers = document.querySelectorAll('.team-member-card-item-trigger');
            if (modal && closeModalBtn && teamMemberTriggers.length > 0) {
                const modalImage = document.getElementById('modal-member-image');
                const modalName = document.getElementById('modal-member-name');
                const modalTitle = document.getElementById('modal-member-title');
                const modalBio = document.getElementById('modal-member-bio');

                const openModal = (memberData) => {
                    modalImage.src = memberData.image;
                    modalImage.alt = `Retrato de ${memberData.name}`;
                    modalName.textContent = memberData.name;
                    modalTitle.textContent = memberData.title;
                    modalBio.innerHTML = memberData.bio.replace(/\n/g, '<br>');
                    modal.classList.remove('hidden');
                    setTimeout(() => modal.querySelector('.modal-content').classList.remove('scale-95'), 10);
                };

                const closeModal = () => {
                    modal.querySelector('.modal-content').classList.add('scale-95');
                    setTimeout(() => modal.classList.add('hidden'), 300);
                };

                teamMemberTriggers.forEach(trigger => {
                    trigger.addEventListener('click', () => {
                        openModal({
                            name: trigger.dataset.memberName,
                            title: trigger.dataset.memberTitle,
                            bio: trigger.dataset.memberBio,
                            image: trigger.dataset.memberImage,
                        });
                    });
                });

                closeModalBtn.addEventListener('click', closeModal);
                modal.addEventListener('click', (e) => e.target === modal && closeModal());
                document.addEventListener('keydown', (e) => e.key === "Escape" && !modal.classList.contains('hidden') && closeModal());
            }
        });
    </script>
{% endblock %}